<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Modo Arte - Proporción Real</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; cursor: none; }
        
        #canvas {
            /* Mantiene la rotación para tu monitor vertical */
            width: 100vh; height: 100vw; transform: rotate(90deg); transform-origin: center;
            position: absolute; top: 50%; left: 50%; margin-left: -50vh; margin-top: -50vw;
            
            /* CORRECCIÓN DE TAMAÑO: 'contain' para no estirar */
            background-size: contain; 
            background-position: center; 
            background-repeat: no-repeat;
            background-color: #000;
        }
    </style>
</head>
<body>
    <div id="canvas"></div>

    <script>
        const CONF = { user: "dylandamian17", repo: "mi-espejo" };
        let obras = [], idx = 0;

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowUp') window.location.href = 'index.html';
            if (obras.length > 0) {
                if (e.key === 'ArrowRight') { idx = (idx + 1) % obras.length; update(); }
                if (e.key === 'ArrowLeft') { idx = (idx - 1 + obras.length) % obras.length; update(); }
            }
        });

        async function init() {
            try {
                // El parámetro ?nocache evita que GitHub te devuelva una lista vieja de archivos
                const res = await fetch(`https://api.github.com/repos/${CONF.user}/${CONF.repo}/contents/arte?t=${Date.now()}`);
                const data = await res.json();
                obras = data.filter(f => f.name.match(/\.(jpg|jpeg|png|webp)$/i)).map(f => f.download_url);
                if(obras.length > 0) update();
            } catch (e) { console.error("Error cargando carpeta /arte"); }
        }

        function update() {
            const el = document.getElementById('canvas');
            // Usamos encodeURI para los nombres con espacios/emojis y un cache-buster al final
            const imageUrl = encodeURI(obras[idx]) + "?t=" + Date.now();
            el.style.backgroundImage = `url('${imageUrl}')`;
        }

        init();
    </script>
</body>
</html>
